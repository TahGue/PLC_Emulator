{
  "annotations": { "list": [] },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "title": "Analyses Total",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 0 },
      "targets": [
        {
          "expr": "analyzer_analyses_total",
          "legendFormat": "total",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "blue", "value": null }
            ]
          }
        },
        "overrides": []
      }
    },
    {
      "title": "Process Anomalies",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 0 },
      "targets": [
        {
          "expr": "analyzer_process_anomalies_total",
          "legendFormat": "anomalies",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "orange", "value": 5 },
              { "color": "red", "value": 20 }
            ]
          }
        },
        "overrides": []
      }
    },
    {
      "title": "Network Alerts",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 8, "y": 0 },
      "targets": [
        {
          "expr": "analyzer_network_alerts_total",
          "legendFormat": "alerts",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "orange", "value": 3 },
              { "color": "red", "value": 10 }
            ]
          }
        },
        "overrides": []
      }
    },
    {
      "title": "Vision Signals Ingested",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 12, "y": 0 },
      "targets": [
        {
          "expr": "analyzer_vision_signals_ingested",
          "legendFormat": "vision",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "purple", "value": null }
            ]
          }
        },
        "overrides": []
      }
    },
    {
      "title": "Security Signals Ingested",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 16, "y": 0 },
      "targets": [
        {
          "expr": "analyzer_security_signals_ingested",
          "legendFormat": "security",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "purple", "value": null }
            ]
          }
        },
        "overrides": []
      }
    },
    {
      "title": "Signal Freshness",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 20, "y": 0 },
      "targets": [
        {
          "expr": "analyzer_vision_signal_fresh",
          "legendFormat": "vision fresh",
          "refId": "A"
        },
        {
          "expr": "analyzer_security_signal_fresh",
          "legendFormat": "security fresh",
          "refId": "B"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "mappings": [
            { "type": "value", "options": { "0": { "text": "STALE", "color": "red" }, "1": { "text": "FRESH", "color": "green" } } }
          ]
        },
        "overrides": []
      }
    },
    {
      "title": "Analysis Rate (per second)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 4 },
      "targets": [
        {
          "expr": "rate(analyzer_analyses_total[1m])",
          "legendFormat": "analyses/s",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "drawStyle": "line", "fillOpacity": 15, "lineWidth": 2 }
        },
        "overrides": []
      }
    },
    {
      "title": "Anomaly & Alert Rate (per second)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 4 },
      "targets": [
        {
          "expr": "rate(analyzer_process_anomalies_total[1m])",
          "legendFormat": "process anomalies/s",
          "refId": "A"
        },
        {
          "expr": "rate(analyzer_network_alerts_total[1m])",
          "legendFormat": "network alerts/s",
          "refId": "B"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "drawStyle": "line", "fillOpacity": 15, "lineWidth": 2 }
        },
        "overrides": []
      }
    },
    {
      "title": "Vision Anomaly Score",
      "type": "gauge",
      "gridPos": { "h": 6, "w": 8, "x": 0, "y": 12 },
      "targets": [
        {
          "expr": "analyzer_vision_anomaly_score",
          "legendFormat": "score",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "min": 0,
          "max": 100,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 40 },
              { "color": "orange", "value": 60 },
              { "color": "red", "value": 80 }
            ]
          }
        },
        "overrides": []
      }
    },
    {
      "title": "Security Packet Rate",
      "type": "gauge",
      "gridPos": { "h": 6, "w": 8, "x": 8, "y": 12 },
      "targets": [
        {
          "expr": "analyzer_security_packet_rate",
          "legendFormat": "pkt/s",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "min": 0,
          "max": 400,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 150 },
              { "color": "orange", "value": 200 },
              { "color": "red", "value": 250 }
            ]
          }
        },
        "overrides": []
      }
    },
    {
      "title": "Signal Ingest Rate (per second)",
      "type": "timeseries",
      "gridPos": { "h": 6, "w": 8, "x": 16, "y": 12 },
      "targets": [
        {
          "expr": "rate(analyzer_vision_signals_ingested[1m])",
          "legendFormat": "vision/s",
          "refId": "A"
        },
        {
          "expr": "rate(analyzer_security_signals_ingested[1m])",
          "legendFormat": "security/s",
          "refId": "B"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "drawStyle": "line", "fillOpacity": 15, "lineWidth": 2 }
        },
        "overrides": []
      }
    }
  ],
  "schemaVersion": 39,
  "tags": ["analyzer", "plc", "anomaly"],
  "templating": { "list": [] },
  "time": { "from": "now-15m", "to": "now" },
  "timepicker": {},
  "timezone": "browser",
  "title": "Bottle Factory Analyzer",
  "uid": "bottle-factory-analyzer",
  "version": 1
}
